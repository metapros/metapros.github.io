<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Create Your Book Bundle - Metapros</title>
  
  <link rel="icon" type="image/png" href="favicon.png">

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Arimo&family=Spectral&display=swap');
    :root { 
        --gold-color: #D4AC0D; 
        --dark-bg: #111; 
        --medium-bg: #1a1a1a; 
        --light-text: #ccc; 
        --white-text: #fff; 
        --image-bg: #131211;
    }
    body { margin: 0; padding: 0; font-family: 'Arimo', sans-serif; background-color: var(--dark-bg); color: #fff; }
    .container { max-width: 1000px; margin: 40px auto; padding: 20px; background-color: var(--medium-bg); border-radius: 12px; box-shadow: 0 0 15px rgba(212, 172, 13, 0.3); }
    
    /* --- ADDED: Header Styles --- */
    .main-header { 
        display: flex; 
        justify-content: space-between; 
        align-items: center; 
        padding: 20px 40px; 
        background-color: #000; 
        margin-bottom: 40px;
    }
    .logo img { 
        height: 60px; 
        vertical-align: middle; 
    }
    .main-nav a { 
        color: var(--white-text); 
        text-decoration: none; 
        margin: 0 15px; 
        font-size: 1rem; 
        font-weight: bold; 
        transition: color 0.3s ease; 
    }
    .main-nav a:hover, .main-nav a.active { 
        color: var(--gold-color); 
    }

    h2 { text-align: center; color: var(--gold-color); margin-bottom: 10px; user-select: none; font-family: 'Spectral', serif; }
    .info-note { text-align: center; color: var(--light-text); font-size: 0.95rem; margin-bottom: 30px; }
    .tabs-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; max-width: 400px; margin: 0 auto 30px auto; user-select: none; }
    .tab { background-color: #333; padding: 18px 0; border-radius: 12px; text-align: center; font-weight: bold; color: #fff; cursor: pointer; transition: all 0.3s ease; font-size: 1.15rem; box-shadow: 0 0 5px transparent; display: flex; align-items: center; justify-content: center; height: 60px; font-family: 'Spectral', serif; }
    .tab:hover { background-color: #b8950b; color: #111; }
    .tab.active { background-color: var(--gold-color); color: #111; box-shadow: 0 0 14px rgba(212, 172, 13, 0.7); transform: scale(1.1); pointer-events: none; }
    .search-container { margin-bottom: 20px; }
    #searchBar { width: 100%; padding: 12px 15px; background-color: #222; border: 1px solid #444; border-radius: 8px; color: #fff; font-size: 1rem; box-sizing: border-box; transition: all 0.3s ease; }
    #searchBar:focus { outline: none; box-shadow: 0 0 12px rgba(212, 172, 13, 0.7); border-color: var(--gold-color); }
    #selectionCounter { text-align: center; color: var(--gold-color); font-size: 1.1rem; margin-bottom: 15px; min-height: 24px; font-weight: bold; }
    .books-section { background-color: #222; border-radius: 12px; padding: 20px; max-height: 420px; overflow-y: auto; box-shadow: 0 0 10px rgba(212, 172, 13, 0.3); }
    .book-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 5px; border-bottom: 1px solid #333; transition: background-color 0.3s ease; }
    .book-item:last-child { border-bottom: none; }
    .book-title { flex: 1; font-size: 1rem; padding-right: 10px; }
    .select-circle { width: 18px; height: 18px; border-radius: 50%; border: 2px solid var(--gold-color); cursor: pointer; transition: all 0.3s ease; flex-shrink: 0; }
    .select-circle.selected { background-color: var(--gold-color); box-shadow: 0 0 12px rgba(212, 172, 13, 0.9); }
    input, textarea { width: 100%; padding: 12px; margin-bottom: 15px; border: none; border-radius: 6px; background-color: #222; color: #fff; font-size: 1rem; transition: box-shadow 0.3s ease; font-family: 'Arimo', sans-serif; box-sizing: border-box; }
    input:focus, textarea:focus { outline: none; box-shadow: 0 0 12px rgba(212, 172, 13, 0.7); }
    button { width: 100%; padding: 16px; font-size: 1.2rem; font-weight: bold; background-color: var(--gold-color); color: #111; border: none; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; font-family: 'Arimo', sans-serif; }
    button:hover:not(:disabled) { background-color: #b8950b; transform: scale(1.02); }
    button:disabled { background-color: #555; cursor: not-allowed; transform: none; }
    .secondary-btn { background-color: transparent; color: var(--gold-color); border: 1px solid var(--gold-color); font-size: 0.9rem; padding: 8px; margin-top: -10px; margin-bottom: 15px; font-weight: normal; }
    .secondary-btn:hover:not(:disabled) { background-color: rgba(212, 172, 13, 0.1); }
    #priceDisplay { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 25px; text-align: center; }
    .price-card { border: 2px solid #444; border-radius: 10px; padding: 15px; transition: all 0.3s ease; }
    .price-card.highlight { border-color: var(--gold-color); box-shadow: 0 0 20px rgba(212, 172, 13, 0.5); transform: scale(1.05); }
    .price-card h4 { margin: 0 0 5px 0; color: #fff; font-family: 'Spectral', serif; font-size: 1.2rem; }
    .price-card .books-count { color: #ccc; font-size: 0.9rem; margin-bottom: 10px; }
    .price-card .final-price { font-size: 1.8rem; font-weight: bold; color: var(--gold-color); margin-bottom: 10px; }
    .price-card .value-prop { font-size: 0.9rem; color: #a0a0a0; min-height: 20px; }
    .best-value-banner { background-color: var(--gold-color); color: #111; font-weight: bold; font-size: 0.8rem; padding: 3px 8px; border-radius: 5px; display: inline-block; margin-bottom: 10px; }
    .custom-bundle-note { text-align: center; margin-top: -10px; margin-bottom: 30px; }
    .custom-bundle-note p { font-size: 1rem; color: #ccc; margin: 0; }
    .custom-bundle-note a { color: var(--gold-color); text-decoration: none; font-weight: bold; transition: color 0.3s ease; }
    .custom-bundle-note a:hover { text-decoration: underline; color: #fff; }
    #thankYouMessage { text-align: center; color: var(--gold-color); display: none; font-size: 1.25rem; opacity: 0; user-select: none; margin-top: 20px; line-height: 1.6; }
    .pop-animation { animation: circle-pop 0.3s ease-in-out; }
    @keyframes circle-pop { 50% { transform: scale(1.4); } }
    @keyframes popIn { from { opacity: 0; transform: scale(0.85); } to { opacity: 1; transform: scale(1); } }
    
    @media (max-width: 768px) { 
        #priceDisplay { grid-template-columns: 1fr; } 
        .main-header { flex-direction: column; }
        .main-nav { margin-top: 15px; }
    }
    @media (max-width: 480px) { .tabs-grid { grid-template-columns: 1fr; } .container { margin: 10px; padding: 15px; } h2 { font-size: 1.5rem; } }
  </style>
</head>
<body>

  <header class="main-header">
    <a href="index.html" class="logo"><img src="logo.png" alt="Metapros Logo"></a>
    <nav class="main-nav">
        <a href="index.html">Home</a>
        <a href="shop.html">Shop</a>
        <a href="bundle.html" class="active">Create Your Bundle</a>
        <a href="#">About</a>
        <a href="#">Contact</a>
    </nav>
  </header>

  <div class="container">
    <h2>Create Your Book Bundle</h2>
    <p class="info-note">Please select at least 3 books to create your bundle.</p>
    <div class="tabs-grid" id="tabsGrid"></div>
    <div class="search-container"><input type="search" id="searchBar" placeholder="Search for a book..."></div>
    <div id="selectionCounter"></div>
    <div class="books-section" id="booksSection"></div>
    <div id="priceDisplay"></div>
    <div class="custom-bundle-note"><p>Need more than 8 books? <a href="#orderForm">Contact us for a custom quote.</a></p></div>
    <form id="orderForm">
      <input type="text" id="name" name="name" placeholder="Full Name" required />
      <input type="email" id="email" name="email" placeholder="Email Address" required />
      <input type="text" id="phone" name="phone" placeholder="WhatsApp or Telegram" required />
      <textarea id="selectedBooks" name="selectedBooks" rows="6" readonly placeholder="Your selected books will appear here..."></textarea>
      <input type="hidden" name="originalPrice" id="originalPriceInput">
      <input type="hidden" name="discountValue" id="discountValueInput">
      <input type="hidden" name="finalPrice" id="finalPriceInput">
      <button type="button" id="clearSelectionBtn" class="secondary-btn">Clear Chosen Books</button>
      <textarea id="userMessage" name="userMessage" rows="4" placeholder="Write a message to us (optional)"></textarea>
      <button type="submit" id="submitButton" disabled>Send Order</button>
    </form>
    <div id="thankYouMessage"></div>
  </div>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbwQwlCZoQAAKdTQn5PIOMvj1xXdCnT8dzVaiJ6eFtxEp221tVem9OeJTc7dJS1zLTgq/exec';
    const categories = {
        "Smart Income": ["Digital Marketing Automation for Solopreneurs", "Make Money with Stock Videos and Clips", "Rent Out Your Digital Assets in 2025", "Create a Passive Income Newsletter", "Digital Subscriptions You Can Launch Fast", "YouTube Cash Machine Without Filming", "Smart Income with Canva Templates", "How to Sell Digital Planners Online", "Monetize Your Knowledge with eBooks", "Affiliate Marketing 2025: Passive Income Blueprint", "Dropshipping 2025: Start with No Capital", "AI-Powered Etsy Shop: Start Today", "Print on Demand Without Design Skills", "Digital Products You Can Create in a Day", "Sell Notion Templates for Profit", "How to Achieve Passive or Extra Income Online", "Passive Income with Modern Tools", "AI To Boost Your Personal Income", "AI Automation for Business Growth 2025", "Dropservicing: Sell Services Easily", "Marketing Dropservicing Services Successfully", "E-Commerce: Strategies for 2025", "How To Start A Dropservicing Business In 2025", "Find the Best Products for Dropshipping Success", "Create and Sell Online Courses in 2025", "The Rise of AI Side Hustles"],
        "Skills Mastery": ["Remote Work Skills for 2025", "Become a Prompt Engineer in 2025", "Master Creative Problem-Solving in 2025", "5 Steps to Start Freelancing", "The Freelancer’s Guide To Financial Freedom", "Voiceover Work from Home in 2025", "Start Freelancing Successfully in 2025", "Increase Your Freelancing Profits", "Self Education Through Virtual Reality", "Learn In Demand Skills for 2025", "Develop Your Career Path Smartly", "Mastering ChatGPT for Business and Cash"],
        "Trading & Wealth": ["Invest In Cryptocurrency Smartly", "Analyzing the Crypto Market for Smart Investors", "Smart Trading Strategies for 2025", "Trading in Financial Markets for Beginners", "Cryptocurrency Beginner's Guide 2025"],
        "Digital Life": ["Growth Strategies for TikTok and Instagram", "Grow Your Social Media Reach", "Create Winning Content in 2025", "Build Your Digital Audience Fast", "Smart Social Media Marketing", "Your Personal Brand in 2025", "Increase Your E-commerce Sales", "Build Your Digital Store Easily", "AI Tools For Productivity", "Live Peacefully in the Social Media Era", "Financial Planning for the Digital Future", "Sustain Your Money in a Changing Era", "Overcome Tech Burnout", "Balance in the Digital Life", "Leadership in the Digital Age", "Design Your Life with AI"]
    };
    const PRICE_PER_BOOK = 6.99;
    const CURRENCY = '$';
    const TIER_PRICES = { tier1: 17.99, tier2: 29.99, tier3: 34.99 };
    const tabsGrid = document.getElementById('tabsGrid');
    const booksSection = document.getElementById('booksSection');
    const selectedBooksField = document.getElementById('selectedBooks');
    const priceDisplay = document.getElementById('priceDisplay');
    const submitBtn = document.getElementById('submitButton');
    const thankYouMessage = document.getElementById('thankYouMessage');
    const orderForm = document.getElementById('orderForm');
    const searchBar = document.getElementById('searchBar');
    const clearSelectionBtn = document.getElementById('clearSelectionBtn');
    const selectionCounter = document.getElementById('selectionCounter');
    let activeCategory = Object.keys(categories)[0];
    const selectedBooks = {};
    function createTabs() {
        tabsGrid.innerHTML = '';
        Object.keys(categories).forEach(category => {
            const tab = document.createElement('div');
            tab.className = 'tab';
            tab.textContent = category;
            if (category === activeCategory) tab.classList.add('active');
            tab.addEventListener('click', () => {
                if (activeCategory !== category) {
                    activeCategory = category;
                    searchBar.value = '';
                    updateActiveTab();
                    renderBooks();
                }
            });
            tabsGrid.appendChild(tab);
        });
    }
    function updateActiveTab() {
        document.querySelectorAll('.tab').forEach(tab => {
            tab.classList.remove('active');
            if (tab.textContent === activeCategory) tab.classList.add('active');
        });
    }
    function renderBooks() {
        booksSection.innerHTML = '';
        const books = categories[activeCategory];
        books.forEach(title => {
            const bookItem = document.createElement('div');
            bookItem.className = 'book-item';
            const bookTitle = document.createElement('span');
            bookTitle.className = 'book-title';
            bookTitle.textContent = title;
            const selectCircle = document.createElement('div');
            selectCircle.className = 'select-circle';
            if (selectedBooks[title]) { selectCircle.classList.add('selected'); }
            selectCircle.addEventListener('click', (e) => {
                const totalCount = Object.keys(selectedBooks).length;
                const isSelected = selectedBooks[title];
                if (!isSelected && totalCount >= 8) {
                    alert('The maximum selection is 8 books for the Ultimate Library bundle. For larger orders, please contact us.');
                    return;
                }
                e.target.classList.add('pop-animation');
                if (isSelected) {
                    delete selectedBooks[title];
                    e.target.classList.remove('selected');
                } else {
                    selectedBooks[title] = true;
                    e.target.classList.add('selected');
                }
                updateSelectedBooks();
                e.target.addEventListener('animationend', () => e.target.classList.remove('pop-animation'), { once: true });
            });
            bookItem.appendChild(bookTitle);
            bookItem.appendChild(selectCircle);
            booksSection.appendChild(bookItem);
        });
        filterBooks();
    }
    function filterBooks() {
        const searchTerm = searchBar.value.toLowerCase();
        const allBookItems = booksSection.querySelectorAll('.book-item');
        allBookItems.forEach(item => {
            const title = item.querySelector('.book-title').textContent.toLowerCase();
            if (title.includes(searchTerm)) { item.style.display = 'flex'; }
            else { item.style.display = 'none'; }
        });
    }
    function updateSelectedBooks() {
        const totalCount = Object.keys(selectedBooks).length;
        selectedBooksField.value = Object.keys(selectedBooks).map(title => `${title} x1`).join('\n');
        if (totalCount === 0) { selectionCounter.textContent = 'Select your books'; }
        else if (totalCount === 1) { selectionCounter.textContent = 'You have selected 1 book'; }
        else { selectionCounter.textContent = `You have selected ${totalCount} books`; }
        let finalPrice = 0;
        let activeTier = -1;
        if (totalCount >= 3 && totalCount <= 5) { finalPrice = TIER_PRICES.tier1; activeTier = 0; }
        else if (totalCount >= 6 && totalCount <= 7) { finalPrice = TIER_PRICES.tier2; activeTier = 1; }
        else if (totalCount === 8) { finalPrice = TIER_PRICES.tier3; activeTier = 2; }
        else { finalPrice = totalCount * PRICE_PER_BOOK; }
        const originalPrice = totalCount * PRICE_PER_BOOK;
        const discountValue = originalPrice - finalPrice;
        document.getElementById('originalPriceInput').value = originalPrice.toFixed(2);
        document.getElementById('discountValueInput').value = discountValue.toFixed(2);
        document.getElementById('finalPriceInput').value = finalPrice.toFixed(2);
        renderPriceDisplay(totalCount, activeTier);
        submitBtn.disabled = totalCount === 0;
        clearSelectionBtn.style.display = totalCount > 0 ? 'block' : 'none';
    }
    function renderPriceDisplay(count, activeTier) {
        priceDisplay.innerHTML = '';
        if (count < 3) return;
        const tiers = [
            { name: 'Starter Pack', books: '3-5 Books', price: TIER_PRICES.tier1, value: `(${CURRENCY}${(TIER_PRICES.tier1 / 3).toFixed(2)}/book)` },
            { name: 'Value Bundle', books: '6-7 Books', price: TIER_PRICES.tier2, value: `You save over ${CURRENCY}${(6 * PRICE_PER_BOOK - TIER_PRICES.tier2).toFixed(0)}!` },
            { name: 'Ultimate Library', books: '8 Books', price: TIER_PRICES.tier3, value: `Only ${CURRENCY}${(TIER_PRICES.tier3 / 8).toFixed(2)}/book!` }
        ];
        tiers.forEach((tier, index) => {
            const card = document.createElement('div');
            card.className = 'price-card';
            if(index === activeTier) card.classList.add('highlight');
            let banner = '';
            if (index === 2) { banner = `<div class="best-value-banner">BEST VALUE</div>`; }
            card.innerHTML = `
                ${banner}
                <h4>${tier.name}</h4>
                <div class="books-count">${tier.books}</div>
                <div class="final-price">${CURRENCY}${tier.price}</div>
                <div class="value-prop">${tier.value}</div>
            `;
            priceDisplay.appendChild(card);
        });
    }
    searchBar.addEventListener('input', filterBooks);
    clearSelectionBtn.addEventListener('click', () => {
        Object.keys(selectedBooks).forEach(key => delete selectedBooks[key]);
        renderBooks();
        updateSelectedBooks();
    });
    orderForm.addEventListener('submit', e => {
        e.preventDefault();
        const totalCount = Object.keys(selectedBooks).length;
        if (totalCount < 3) { alert('You must choose at least 3 books to place an order.'); return; }
        submitBtn.disabled = true;
        submitBtn.textContent = "Sending...";
        const userName = document.getElementById('name').value;
        fetch(scriptURL, { method: 'POST', body: new FormData(orderForm)})
            .then(response => {
                if (response.ok) {
                    orderForm.style.display = 'none';
                    priceDisplay.style.display = 'none';
                    document.querySelector('.custom-bundle-note').style.display = 'none';
                    document.querySelector('.info-note').style.display = 'none';
                    thankYouMessage.innerHTML = `Thank you, <b>${userName}</b>!<br>We've received your order for ${totalCount} books and will be in touch shortly.`;
                    thankYouMessage.style.display = 'block';
                    thankYouMessage.style.animation = 'popIn 0.6s ease forwards';
                } else { throw new Error('Network response was not ok.'); }
            })
            .catch(error => {
                console.error('Error!', error.message);
                alert('An error occurred while submitting the form. Please try again.');
                submitBtn.disabled = false;
                submitBtn.textContent = "Send Order";
            });
    });
    createTabs();
    renderBooks();
    updateSelectedBooks();
  </script>
</body>
</html>
